<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->
    
    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.min.js"></script>
    <script src="lib/ionic/js/angular/angular-resource.min.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <!-- <script src="cordova.js"></script> -->

    <!-- your app's js -->
    <script src="js/app.js"></script>
    <script src="js/controllers.js"></script>
    <script src="js/services.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/resources.js?v=0.3"></script>
  </head>
  <body ng-app="move_car">
    <!--
      The nav bar that will be updated as we navigate between views.
    -->
    <!-- <ion-nav-bar class="bar-stable">
      <ion-nav-back-button>
      </ion-nav-back-button>
    </ion-nav-bar> -->
    <!--
      The views will be rendered in the <ion-nav-view> directive below
      Templates are in the /templates folder (but you could also
      have templates inline in this html file if you'd like).
    -->
    <ion-nav-view></ion-nav-view>
  </body>
  <!-- Weixin Config -->
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script type="text/javascript">
        (function(window){
          /**获取配置*/
          window.callback_config = function callback_config(config){
            console.log(config);
            wx.config({
                debug: false,
                appId: config.appId,
                timestamp: config.timestamp,
                nonceStr: config.nonceStr,
                signature: config.signature,

               
                jsApiList: [
                    'checkJsApi',
                    'onMenuShareTimeline',
                    'onMenuShareAppMessage',
                    'onMenuShareQQ',
                    'onMenuShareWeibo',
                    'hideMenuItems',
                    'showMenuItems',
                    'hideAllNonBaseMenuItem',
                    'showAllNonBaseMenuItem',
                    'translateVoice',
                    'startRecord',
                    'stopRecord',
                    'onRecordEnd',
                    'playVoice',
                    'pauseVoice',
                    'stopVoice',
                    'uploadVoice',
                    'downloadVoice',
                    'chooseImage',
                    'previewImage',
                    'uploadImage',
                    'downloadImage',
                    'getNetworkType',
                    'openLocation',
                    'getLocation',
                    'hideOptionMenu',
                    'showOptionMenu',
                    'closeWindow',
                    'scanQRCode',
                    'chooseWXPay',
                    'openProductSpecificView',
                    'addCard',
                    'chooseCard',
                    'openCard'
                  // 所有要调用的 API 都要加到这个列表中
                ]
            });

            var wxData = {
            "appId": "",
            "imgUrl" : 'http://ip.yn122.net/cyh/move_car/www/img/car_mate_logo.png',
            "link" : 'http://ip.yn122.net:8090/mc_api',
            "desc" : '车友惠挪车',
            "title" : "车友惠挪车"
            };
            var str_mp = "weixin://profile/gh_8592a4c9c934";//关注的链接
            wx.ready(function () {
            // 2. 分享接口
            // 2.1 监听“分享给朋友”，按钮点击、自定义分享内容及分享结果接口
                wx.onMenuShareAppMessage({
                  title: wxData.title,
                  desc: wxData.desc,
                  link:wxData.link ,
                  imgUrl: wxData.imgUrl,
                  trigger: function (res) {
                    
                  },
                  success: function (res) {
                  location.href = str_mp;//关注的链接
                  },
                  cancel: function (res) {
                   //alert("如此嗨的福利，真的不分享给朋友吗？");
                  },
                  fail: function (res) {
                     alert(JSON.stringify(res));
                  }
                });

                wx.onMenuShareTimeline({
                  title: wxData.title,
                  desc: wxData.desc,
                  link: wxData.link,
                  imgUrl: wxData.imgUrl,
                  trigger: function (res) {
                  },
                  success: function (res) {
                  location.href = str_mp;//关注的链接
                  },
                  cancel: function (res) { 
                    //alert("如此嗨的福利，真的不分享给朋友吗？");
                  },
                  fail: function (res) {
                    alert(JSON.stringify(res));
                  }
                });
                
                //alert('wx_config ok!');
            });

            wx.error(function (res) {
              alert(res.errMsg);
            });
          };
          
          var script = document.createElement('script');
          script.src =  "http://116.55.248.76/wxjs_config/config.php?callback=callback_config&url=" + encodeURIComponent( window.location.href.split('#')[0] );
          var body = document.getElementsByTagName('body')[0];
          body.appendChild(script);
        })(window);
    </script>
</html>
